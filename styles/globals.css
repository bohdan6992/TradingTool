@tailwind base;
@tailwind components;
@tailwind utilities;

/* ---------------- Base vars ---------------- */
@layer base {
  :root {
    --bg: #0b0f1a;
    --fg: #e6edf6;
    --muted: #93a1be;
    --color-primary: #60a5fa;

    /* масштабування */
    --base-width: 1920;
    --scale: 1;
    --offsetX: 0px;

    /* topbar */
    --topbar-h: 72;       /* базова висота, px, без scale */
    --topbar-k: 1;        /* множник висоти (можна змінити у media) */
    --topbar-gap: 26px;   /* додаткове «повітря» під баром */

    /* головна змінна: відступ від fixed topbar */
    --tt-offset: calc(
      var(--topbar-h) * var(--topbar-k, 1) * var(--scale, 1)
      + var(--topbar-gap, 26px)
      + env(safe-area-inset-top, 0px)
    );
  }

  html, body { height: 100%; }

  /* !!! НІЯКИХ padding-top на body */
  body {
    @apply bg-white text-slate-900 dark:bg-[var(--bg)] dark:text-slate-100;
  }

  a { @apply text-inherit no-underline; }
  a:hover { @apply underline decoration-1 decoration-white/40 dark:decoration-white/30; }
}

/* ---------------- Layout helpers ---------------- */
#tt-root{
  /* Саме цей контейнер відсуває ВСЕ від fixed topbar */
  padding-top: var(--tt-offset);
}

#app-scale{
  width: calc(var(--base-width) * 1px);
  transform-origin: top left;
  transform: translateX(var(--offsetX)) scale(var(--scale));
  will-change: transform;
}

.card, .nav, .tabs, .topbar, .clock, .strategy-tabs {
  transform: translateZ(0);
  backface-visibility: hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.nowrap { white-space: nowrap; }
.nowrap > * { flex: 0 0 auto; }
.tabular-nums { font-variant-numeric: tabular-nums; }

/* ---------------- Topbar ---------------- */
.tt-topbar{
  position: fixed !important;
  top: 0; left: 0; right: 0;
  z-index: 1000;
  height: calc(var(--topbar-h) * var(--topbar-k, 1) * var(--scale, 1));
  padding: 0;
  margin: 0;
}

.tt-topbar-viewport{
  width: calc(var(--base-width) * 1px);
  transform-origin: top left;
  transform: translateX(var(--offsetX)) scale(var(--scale));
}

.tt-topbar-inner{
  width: 100%;
  max-width: none;
  padding: 0 20px;
  height: calc(var(--topbar-h) * var(--topbar-k, 1) * 1px);
}

/* ---------------- Zoom-mode overrides ---------------- */
.zoom-mode .container,
.zoom-mode [class*="max-w-"] { max-width: none !important; }

.zoom-mode .tt-topbar-inner,
.zoom-mode .page,
.zoom-mode .content,
.zoom-mode .wrap,
.zoom-mode .nytopbar__grid {
  width: calc(var(--base-width) * 1px) !important;
  margin-left: auto; margin-right: auto;
}

.zoom-mode main {
  max-width: none !important;
  width: calc(var(--base-width) * 1px) !important;
  margin-left: auto; margin-right: auto;
  padding-left: 0; padding-right: 0;
}

.zoom-mode main > section { padding-left: 20px; padding-right: 20px; }
.zoom-mode * { overflow: visible; }

/* ---------------- Mobile tweaks ---------------- */
@media (max-width: 768px){
  html { font-size: 150%; }
  :root{
    --topbar-k: 0.55;  /* нижчий бар на мобільних */
    --topbar-gap: 34px;
  }

  .tt-topbar-inner{ padding: 0 12px; gap: 8px; }
}

/* універсальний відступ зверху під fixed topbar */
main, .page, .content, #app-scale {
  margin-top: 100px !important; /* або скільки треба */
}

/* Токени для плиток (дефолти; теми перекриють значенням нижче) */
:root {
  --tile-bg: color-mix(in oklab, #ffffff 6%, transparent);
  --tile-border: rgba(255,255,255,.12);
  --tile-shadow: rgba(0,0,0,.35);
  --tile-glow: color-mix(in oklab, var(--color-primary) 28%, transparent);
  --tile-track: rgba(255,255,255,.08);
  --tile-fill-start: var(--color-primary);
  --tile-fill-end: color-mix(in oklab, var(--color-primary) 60%, #22d3ee);
  --tile-spark: color-mix(in oklab, var(--color-primary) 70%, #9ae6b4);

  --chip-bg: color-mix(in oklab, #ffffff 10%, transparent);
  --chip-fg: var(--fg);
  --chip-border: rgba(255,255,255,.14);

  --chip-hot-bg: color-mix(in oklab, #ef4444 28%, transparent);
  --chip-hot-fg: #ffecec;
}

html.dark :root,
html[data-theme*="dark"] {
  --tile-bg: color-mix(in oklab, #ffffff 7%, transparent);
  --tile-border: rgba(255,255,255,.10);
  --tile-track: rgba(255,255,255,.08);
}

/* Гарні чіпи для тікерів */
.chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 10px;
  border-radius: 999px;
  font-size: 12px;
  line-height: 1;
  color: var(--chip-fg);
  background: var(--chip-bg);
  border: 1px solid var(--chip-border);
  box-shadow: 0 6px 18px -12px rgba(0,0,0,.35) inset, 0 1px 0 rgba(255,255,255,.05);
  backdrop-filter: blur(6px);
}

/* плавність ширини прогреса */
@keyframes growWidth { from { width: 0 } to { width: var(--w, 100%) } }
